
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CTGAN Model &#8212; SDV 0.4.1 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/SDV-Logo-Black.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Handling Constraints" href="04_Handling_Constraints.html" />
    <link rel="prev" title="GaussianCopula Model" href="02_GaussianCopula_Model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/SDV-Logo-Color.png" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../../user_guides/index.html">User Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../api_reference/index.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../developer_guides/index.html">Developer Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../history.html">Release Notes</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/sdv-dev/SDV" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
        
          

              <li class="active">
                  <a href="../../user_guides/single_table.html">Single Table Data</a>
                  <ul>
                  
                      <li class="">
                          <a href="01_Tabular_Models.html">Tabular Models</a>
                      </li>
                  
                      <li class="">
                          <a href="02_GaussianCopula_Model.html">GaussianCopula Model</a>
                      </li>
                  
                      <li class="active">
                          <a href="">CTGAN Model</a>
                      </li>
                  
                      <li class="">
                          <a href="04_Handling_Constraints.html">Handling Constraints</a>
                      </li>
                  
                  </ul>
              </li>
          
        
          
              <li class="">
                  <a href="../../user_guides/relational.html">Relational Data</a>
              </li>
          
        
      
      
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#Modeling-Tabular-data-using-Conditional-GAN" class="nav-link">Modeling Tabular data using Conditional GAN</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#Introducing-CTGAN" class="nav-link">Introducing CTGAN</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#CTGAN-Hyperparameters" class="nav-link">CTGAN Hyperparameters</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#epochs-and-batch-size" class="nav-link">epochs and batch size</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#log_frequency" class="nav-link">log_frequency</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#Neural-Network-dimensions" class="nav-link">Neural Network dimensions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#l2scale" class="nav-link">l2scale</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#verbose" class="nav-link">verbose</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><div class="section" id="CTGAN-Model">
<h1>CTGAN Model<a class="headerlink" href="#CTGAN-Model" title="Permalink to this headline">¶</a></h1>
<p>In this guide we present the <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> model: A GAN-based Deep Learning data synthesizer that can generate synthetic tabular data with high fidelity. Based on our <a class="reference external" href="https://github.com/sdv-dev/CTGAN">CTGAN Library</a>.</p>
<div class="admonition note">
<p class="admonition-title"><strong>NOTE</strong></p>
<p>During this guide we will walk you through the specific functionalities of the <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> model. For a more generic view of the SDV Tabular Models and their common functionalities, please visit the <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide.</p>
</div>
<div class="section" id="Modeling-Tabular-data-using-Conditional-GAN">
<h2>Modeling Tabular data using Conditional GAN<a class="headerlink" href="#Modeling-Tabular-data-using-Conditional-GAN" title="Permalink to this headline">¶</a></h2>
<p><strong>CTGAN</strong> is a Deep Learning based data syntheziser that uses Generative Adversarial Networks to generate tabular data and which was presented at the NeurIPS 2020 conference by the paper titled <a class="reference external" href="https://arxiv.org/abs/1907.00503">Modeling Tabular data using Conditional GAN</a>. For more details about it, please read the linked paper and visit the <a class="reference external" href="https://github.com/sdv-dev/CTGAN">CTGAN library</a>.</p>
<p>Let’s now discover how to learn a dataset and later on generate synthetic data with the same format and statistical properties by using the <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> class from SDV.</p>
<div class="admonition warning">
<p class="admonition-title">WARNING</p>
<p>In order to follow this guide you need to have <code class="docutils literal notranslate"><span class="pre">ctgan</span></code> installed on your system. If you have not done it yet, please install <code class="docutils literal notranslate"><span class="pre">ctgan</span></code> now by executing the command <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sdv[ctgan]</span></code> in a terminal.</p>
</div>
</div>
<div class="section" id="Introducing-CTGAN">
<h2>Introducing CTGAN<a class="headerlink" href="#Introducing-CTGAN" title="Permalink to this headline">¶</a></h2>
<p>We will start by loading one of our demo datasets, the <code class="docutils literal notranslate"><span class="pre">student_placements</span></code>, which we used during <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.demo</span> <span class="kn">import</span> <span class="n">load_tabular_demo</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">load_tabular_demo</span><span class="p">(</span><span class="s1">&#39;student_placements&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>student_id</th>
      <td>155368</td>
      <td>155369</td>
      <td>155370</td>
      <td>155371</td>
      <td>155372</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>M</td>
      <td>M</td>
      <td>M</td>
      <td>M</td>
      <td>M</td>
    </tr>
    <tr>
      <th>second_perc</th>
      <td>67</td>
      <td>79.33</td>
      <td>65</td>
      <td>56</td>
      <td>85.8</td>
    </tr>
    <tr>
      <th>high_perc</th>
      <td>91</td>
      <td>78.33</td>
      <td>68</td>
      <td>52</td>
      <td>73.6</td>
    </tr>
    <tr>
      <th>high_spec</th>
      <td>Commerce</td>
      <td>Science</td>
      <td>Arts</td>
      <td>Science</td>
      <td>Commerce</td>
    </tr>
    <tr>
      <th>degree_perc</th>
      <td>58</td>
      <td>77.48</td>
      <td>64</td>
      <td>52</td>
      <td>73.3</td>
    </tr>
    <tr>
      <th>degree_type</th>
      <td>Sci&amp;Tech</td>
      <td>Sci&amp;Tech</td>
      <td>Comm&amp;Mgmt</td>
      <td>Sci&amp;Tech</td>
      <td>Comm&amp;Mgmt</td>
    </tr>
    <tr>
      <th>work_experience</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>experience_years</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>employability_perc</th>
      <td>55</td>
      <td>86.5</td>
      <td>75</td>
      <td>66</td>
      <td>96.8</td>
    </tr>
    <tr>
      <th>mba_spec</th>
      <td>Mkt&amp;HR</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;HR</td>
      <td>Mkt&amp;Fin</td>
    </tr>
    <tr>
      <th>mba_perc</th>
      <td>58.8</td>
      <td>66.28</td>
      <td>57.8</td>
      <td>59.43</td>
      <td>55.5</td>
    </tr>
    <tr>
      <th>salary</th>
      <td>27000</td>
      <td>20000</td>
      <td>25000</td>
      <td>NaN</td>
      <td>42500</td>
    </tr>
    <tr>
      <th>placed</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>start_date</th>
      <td>2020-01-08 00:00:00</td>
      <td>2020-01-15 00:00:00</td>
      <td>2020-01-30 00:00:00</td>
      <td>NaT</td>
      <td>2020-01-16 00:00:00</td>
    </tr>
    <tr>
      <th>end_date</th>
      <td>2020-04-17 00:00:00</td>
      <td>2020-04-02 00:00:00</td>
      <td>2020-04-27 00:00:00</td>
      <td>NaT</td>
      <td>2020-04-28 00:00:00</td>
    </tr>
    <tr>
      <th>duration</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As we learned in the <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide, the first step that we need to do in order to use tabular model like <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> is to import its class and create an instance of it passing the details about our data.</p>
<p>In this case, we would only need to indicate that the primary key is the <code class="docutils literal notranslate"><span class="pre">student_id</span></code> field and call its <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.tabular</span> <span class="kn">import</span> <span class="n">CTGAN</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CTGAN</span><span class="p">(</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After this is done, we can simply call its <code class="docutils literal notranslate"><span class="pre">sample</span></code> method to obtain syntehtically generated data from it:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>gender</th>
      <th>second_perc</th>
      <th>high_perc</th>
      <th>high_spec</th>
      <th>degree_perc</th>
      <th>degree_type</th>
      <th>work_experience</th>
      <th>experience_years</th>
      <th>employability_perc</th>
      <th>mba_spec</th>
      <th>mba_perc</th>
      <th>salary</th>
      <th>placed</th>
      <th>start_date</th>
      <th>end_date</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>F</td>
      <td>55.673440</td>
      <td>35.385329</td>
      <td>Science</td>
      <td>77.910653</td>
      <td>Sci&amp;Tech</td>
      <td>False</td>
      <td>0</td>
      <td>67.267717</td>
      <td>Mkt&amp;HR</td>
      <td>57.796472</td>
      <td>26961.957338</td>
      <td>True</td>
      <td>NaT</td>
      <td>2020-03-30 11:29:56.959432960</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>M</td>
      <td>57.898309</td>
      <td>53.293088</td>
      <td>Commerce</td>
      <td>67.198933</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>1</td>
      <td>73.089297</td>
      <td>Mkt&amp;HR</td>
      <td>66.888349</td>
      <td>NaN</td>
      <td>True</td>
      <td>2020-02-16 00:03:24.176280576</td>
      <td>NaT</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>M</td>
      <td>59.027578</td>
      <td>37.784593</td>
      <td>Science</td>
      <td>66.922251</td>
      <td>Sci&amp;Tech</td>
      <td>False</td>
      <td>1</td>
      <td>74.090553</td>
      <td>Mkt&amp;HR</td>
      <td>66.220386</td>
      <td>17684.222919</td>
      <td>True</td>
      <td>2019-12-19 21:22:16.301072128</td>
      <td>2020-12-08 09:33:28.105755136</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>M</td>
      <td>50.055418</td>
      <td>38.609832</td>
      <td>Arts</td>
      <td>78.842213</td>
      <td>Comm&amp;Mgmt</td>
      <td>True</td>
      <td>0</td>
      <td>95.951477</td>
      <td>Mkt&amp;HR</td>
      <td>73.716787</td>
      <td>32224.660930</td>
      <td>False</td>
      <td>2020-01-23 14:08:04.391622912</td>
      <td>2020-03-10 22:05:46.568782592</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>F</td>
      <td>49.980109</td>
      <td>60.661264</td>
      <td>Commerce</td>
      <td>76.132861</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>0</td>
      <td>55.252820</td>
      <td>Mkt&amp;HR</td>
      <td>60.326783</td>
      <td>28482.033544</td>
      <td>True</td>
      <td>2019-12-12 04:15:40.063726592</td>
      <td>2020-10-19 10:05:23.907214336</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="CTGAN-Hyperparameters">
<h2>CTGAN Hyperparameters<a class="headerlink" href="#CTGAN-Hyperparameters" title="Permalink to this headline">¶</a></h2>
<p>A part from the common Tabular Model arguments, <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> has a number of additional hyperparameters that control its learning behavior and can impact on the performance of the model, both in terms of quality of the generated data and computationa time.</p>
<div class="section" id="epochs-and-batch-size">
<h3>epochs and batch size<a class="headerlink" href="#epochs-and-batch-size" title="Permalink to this headline">¶</a></h3>
<p>The first hyperparameters that we see are the <code class="docutils literal notranslate"><span class="pre">epochs</span></code> and <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> arguments, which control the number of iterations that the model will perform to optimize its parameters, as well as the number of samples used in each step.</p>
<p>Its default values are <code class="docutils literal notranslate"><span class="pre">300</span></code> and <code class="docutils literal notranslate"><span class="pre">500</span></code> respectively, and <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> needs to always be a value which is multiple of <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
<p>These hyperparameters have a very direct effect in time the training process lasts, but also on the performance of the data.</p>
<p>For new datasets, you might want to start by setting a low value on both of them to see how long the training process takes on your data and later on increase the number to acceptable values in order to improve the performance.</p>
</div>
<div class="section" id="log_frequency">
<h3>log_frequency<a class="headerlink" href="#log_frequency" title="Permalink to this headline">¶</a></h3>
<p>Whether to use log frequency of categorical levels in conditional sampling.</p>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>This argument affects how the model processes the frequencies of the categorical values that are used to condition the rest of the values. In some cases, changing it to <code class="docutils literal notranslate"><span class="pre">False</span></code> could lead to better performance.</p>
</div>
<div class="section" id="Neural-Network-dimensions">
<h3>Neural Network dimensions<a class="headerlink" href="#Neural-Network-dimensions" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> has the following hyperparameters that allow you to control the size of the different layers that compose its neural networks:</p>
<ul class="simple">
<li><p>embedding_dim (int): Size of the random sample passed to the Generator. Defaults to 128.</p></li>
<li><p>gen_dim (tuple or list of ints): Size of the output samples for each one of the Residuals. A Resiudal Layer will be created for each one of the values provided. Defaults to (256, 256).</p></li>
<li><p>dis_dim (tuple or list of ints): Size of the output samples for each one of the Discriminator Layers. A Linear Layer will be created for each one of the values provided. Defaults to (256, 256).</p></li>
</ul>
</div>
<div class="section" id="l2scale">
<h3>l2scale<a class="headerlink" href="#l2scale" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">l2scale</span></code> argument, which defaults to <code class="docutils literal notranslate"><span class="pre">1e-6</span></code>, sets the wheight Decay of the Adam Optimizer used to optimize the Neural Networks.</p>
</div>
<div class="section" id="verbose">
<h3>verbose<a class="headerlink" href="#verbose" title="Permalink to this headline">¶</a></h3>
<p>Whether to print fit progress on stdout. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title"><strong>WARNING</strong></p>
<p>The value that you set on the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> argument must always be a multiple of <code class="docutils literal notranslate"><span class="pre">10</span></code>!</p>
</div>
<p>As an example, we will try to fit the <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> model slightly increasing the number of epochs, reducing the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>, adding one additional layer to the models involved and using a smaller wright decay.</p>
<p>Before we start, we will evaluate the qualtiy of the previously generated data using the <code class="docutils literal notranslate"><span class="pre">sdv.evaluation.evaluate</span></code> function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.evaluation</span> <span class="kn">import</span> <span class="n">evaluate</span>

<span class="n">evaluate</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-148.173551500529
</pre></div></div>
</div>
<p>Afterwards, we create a new instance of the <code class="docutils literal notranslate"><span class="pre">CTGAN</span></code> model with the hyperparameter values that we want to use</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">CTGAN</span><span class="p">(</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">gen_dim</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
    <span class="n">dis_dim</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
    <span class="n">l2scale</span><span class="o">=</span><span class="mf">1e-07</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>And fit to our data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we are ready to generate new data and evaluate the results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>gender</th>
      <th>second_perc</th>
      <th>high_perc</th>
      <th>high_spec</th>
      <th>degree_perc</th>
      <th>degree_type</th>
      <th>work_experience</th>
      <th>experience_years</th>
      <th>employability_perc</th>
      <th>mba_spec</th>
      <th>mba_perc</th>
      <th>salary</th>
      <th>placed</th>
      <th>start_date</th>
      <th>end_date</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>F</td>
      <td>34.949775</td>
      <td>56.543753</td>
      <td>Science</td>
      <td>56.386929</td>
      <td>Others</td>
      <td>True</td>
      <td>0</td>
      <td>57.047205</td>
      <td>Mkt&amp;HR</td>
      <td>70.880870</td>
      <td>52487.953908</td>
      <td>False</td>
      <td>2020-02-11 14:51:51.540146176</td>
      <td>NaT</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>M</td>
      <td>60.293816</td>
      <td>63.604466</td>
      <td>Commerce</td>
      <td>57.213664</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>1</td>
      <td>76.443608</td>
      <td>Mkt&amp;Fin</td>
      <td>69.989944</td>
      <td>49340.176244</td>
      <td>False</td>
      <td>NaT</td>
      <td>2020-08-22 07:51:09.761925888</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>M</td>
      <td>65.549707</td>
      <td>67.099558</td>
      <td>Science</td>
      <td>67.883755</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>0</td>
      <td>63.329463</td>
      <td>Mkt&amp;HR</td>
      <td>77.980852</td>
      <td>NaN</td>
      <td>False</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>M</td>
      <td>31.861321</td>
      <td>51.808897</td>
      <td>Commerce</td>
      <td>59.313310</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>4</td>
      <td>91.136983</td>
      <td>Mkt&amp;Fin</td>
      <td>84.226341</td>
      <td>NaN</td>
      <td>False</td>
      <td>NaT</td>
      <td>2020-07-21 22:16:00.456667392</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>F</td>
      <td>78.827052</td>
      <td>75.281691</td>
      <td>Commerce</td>
      <td>64.924865</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>1</td>
      <td>68.389091</td>
      <td>Mkt&amp;Fin</td>
      <td>80.486051</td>
      <td>51901.492908</td>
      <td>False</td>
      <td>2020-01-25 13:18:42.237984512</td>
      <td>NaT</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>210</th>
      <td>210</td>
      <td>M</td>
      <td>67.010665</td>
      <td>43.334043</td>
      <td>Science</td>
      <td>58.679588</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>0</td>
      <td>89.946393</td>
      <td>Mkt&amp;Fin</td>
      <td>78.518156</td>
      <td>NaN</td>
      <td>False</td>
      <td>NaT</td>
      <td>2020-10-02 00:22:02.203142656</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>211</th>
      <td>211</td>
      <td>M</td>
      <td>60.100223</td>
      <td>68.346138</td>
      <td>Science</td>
      <td>72.964973</td>
      <td>Sci&amp;Tech</td>
      <td>False</td>
      <td>0</td>
      <td>101.124253</td>
      <td>Mkt&amp;Fin</td>
      <td>76.647721</td>
      <td>32727.642571</td>
      <td>False</td>
      <td>2020-02-13 20:57:41.302214656</td>
      <td>2021-01-03 03:54:04.681563904</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>212</td>
      <td>M</td>
      <td>54.662673</td>
      <td>56.751646</td>
      <td>Commerce</td>
      <td>60.198562</td>
      <td>Comm&amp;Mgmt</td>
      <td>True</td>
      <td>0</td>
      <td>50.684929</td>
      <td>Mkt&amp;HR</td>
      <td>66.078017</td>
      <td>NaN</td>
      <td>False</td>
      <td>2020-03-01 10:52:01.466955776</td>
      <td>2020-08-19 20:15:37.505603072</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>213</td>
      <td>M</td>
      <td>57.984654</td>
      <td>51.599140</td>
      <td>Science</td>
      <td>69.113537</td>
      <td>Comm&amp;Mgmt</td>
      <td>False</td>
      <td>0</td>
      <td>61.562135</td>
      <td>Mkt&amp;HR</td>
      <td>72.756443</td>
      <td>39093.193199</td>
      <td>False</td>
      <td>2020-02-08 20:32:23.699396864</td>
      <td>NaT</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>214</th>
      <td>214</td>
      <td>M</td>
      <td>75.410205</td>
      <td>45.309435</td>
      <td>Commerce</td>
      <td>56.887853</td>
      <td>Comm&amp;Mgmt</td>
      <td>True</td>
      <td>0</td>
      <td>57.045367</td>
      <td>Mkt&amp;Fin</td>
      <td>55.734951</td>
      <td>23783.166142</td>
      <td>False</td>
      <td>2020-01-07 07:47:50.705248000</td>
      <td>NaT</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
<p>215 rows × 17 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.evaluation</span> <span class="kn">import</span> <span class="n">evaluate</span>

<span class="n">evaluate</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-153.27980312716866
</pre></div></div>
</div>
<p>As we can see, in this case these modifications changed the obtained results slightly, but they did neither introduce dramatic changes in the performance.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="02_GaussianCopula_Model.html" title="previous page">GaussianCopula Model</a>
    <a class='right-next' id="next-link" href="04_Handling_Constraints.html" title="next page">Handling Constraints</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.30270b6e4c972e43c488.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>