
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GaussianCopula Model &#8212; SDV 0.4.1 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/SDV-Logo-Black.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CTGAN Model" href="03_CTGAN_Model.html" />
    <link rel="prev" title="Tabular Models" href="01_Tabular_Models.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/SDV-Logo-Color.png" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../../user_guides/index.html">User Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../api_reference/index.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../developer_guides/index.html">Developer Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../history.html">Release Notes</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/sdv-dev/SDV" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
        
          

              <li class="active">
                  <a href="../../user_guides/single_table.html">Single Table Data</a>
                  <ul>
                  
                      <li class="">
                          <a href="01_Tabular_Models.html">Tabular Models</a>
                      </li>
                  
                      <li class="active">
                          <a href="">GaussianCopula Model</a>
                      </li>
                  
                      <li class="">
                          <a href="03_CTGAN_Model.html">CTGAN Model</a>
                      </li>
                  
                      <li class="">
                          <a href="04_Handling_Constraints.html">Handling Constraints</a>
                      </li>
                  
                  </ul>
              </li>
          
        
          
              <li class="">
                  <a href="../../user_guides/relational.html">Relational Data</a>
              </li>
          
        
      
      
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#What-is-a-Gaussian-Copula?" class="nav-link">What is a Gaussian Copula?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#Introducing-the-GaussianCopula" class="nav-link">Introducing the GaussianCopula</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#Exploring-the-Probability-Distributions" class="nav-link">Exploring the Probability Distributions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#Customizing-the-Probability-Distributions" class="nav-link">Customizing the Probability Distributions</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><div class="section" id="GaussianCopula-Model">
<h1>GaussianCopula Model<a class="headerlink" href="#GaussianCopula-Model" title="Permalink to this headline">¶</a></h1>
<p>In this guide we present the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model: A tool to model multivariate distributions using <a class="reference external" href="https://en.wikipedia.org/wiki/Copula_%28probability_theory%29">copula functions</a>, which is based on our <a class="reference external" href="https://github.com/sdv-dev/Copulas">Copulas Library</a>.</p>
<div class="admonition note">
<p class="admonition-title"><strong>NOTE</strong></p>
<p>During this guide we will walk you through the specific functionalities of the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code>. For a more generic view of the SDV Tabular Models and their common functionalities, please visit the <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide.</p>
</div>
<div class="section" id="What-is-a-Gaussian-Copula?">
<h2>What is a Gaussian Copula?<a class="headerlink" href="#What-is-a-Gaussian-Copula?" title="Permalink to this headline">¶</a></h2>
<p>In mathematical terms, a Gaussian Copula is a distribution over the unit cube <span class="math notranslate nohighlight">\({\displaystyle [0,1]^{d}}\)</span> which is constructed from a multivariate normal distribution over <span class="math notranslate nohighlight">\({\displaystyle \mathbb {R} ^{d}}\)</span> by using the probability integral transform.</p>
<p>Intuitively, a Copula is a mathematical function that allows us to describe the joint distribution of multiple random variables by analyzing the dependencies between their marginal distributions.</p>
<p>For more details about Copulas, please visit the <a class="reference external" href="https://sdv.dev/Copulas/tutorials/01_Introduction_to_Copulas.html">Copulas library documentation</a></p>
<p>Let’s now discover how to learn a dataset and later on generate synthetic data with the same format and statistical properties by using the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model.</p>
</div>
<div class="section" id="Introducing-the-GaussianCopula">
<h2>Introducing the GaussianCopula<a class="headerlink" href="#Introducing-the-GaussianCopula" title="Permalink to this headline">¶</a></h2>
<p>We will start by loading one of our demo datasets, the <code class="docutils literal notranslate"><span class="pre">student_placements</span></code>, which we used during <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.demo</span> <span class="kn">import</span> <span class="n">load_tabular_demo</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">load_tabular_demo</span><span class="p">(</span><span class="s1">&#39;student_placements&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>student_id</th>
      <td>155368</td>
      <td>155369</td>
      <td>155370</td>
      <td>155371</td>
      <td>155372</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>M</td>
      <td>M</td>
      <td>M</td>
      <td>M</td>
      <td>M</td>
    </tr>
    <tr>
      <th>second_perc</th>
      <td>67</td>
      <td>79.33</td>
      <td>65</td>
      <td>56</td>
      <td>85.8</td>
    </tr>
    <tr>
      <th>high_perc</th>
      <td>91</td>
      <td>78.33</td>
      <td>68</td>
      <td>52</td>
      <td>73.6</td>
    </tr>
    <tr>
      <th>high_spec</th>
      <td>Commerce</td>
      <td>Science</td>
      <td>Arts</td>
      <td>Science</td>
      <td>Commerce</td>
    </tr>
    <tr>
      <th>degree_perc</th>
      <td>58</td>
      <td>77.48</td>
      <td>64</td>
      <td>52</td>
      <td>73.3</td>
    </tr>
    <tr>
      <th>degree_type</th>
      <td>Sci&amp;Tech</td>
      <td>Sci&amp;Tech</td>
      <td>Comm&amp;Mgmt</td>
      <td>Sci&amp;Tech</td>
      <td>Comm&amp;Mgmt</td>
    </tr>
    <tr>
      <th>work_experience</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>experience_years</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>employability_perc</th>
      <td>55</td>
      <td>86.5</td>
      <td>75</td>
      <td>66</td>
      <td>96.8</td>
    </tr>
    <tr>
      <th>mba_spec</th>
      <td>Mkt&amp;HR</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;HR</td>
      <td>Mkt&amp;Fin</td>
    </tr>
    <tr>
      <th>mba_perc</th>
      <td>58.8</td>
      <td>66.28</td>
      <td>57.8</td>
      <td>59.43</td>
      <td>55.5</td>
    </tr>
    <tr>
      <th>salary</th>
      <td>27000</td>
      <td>20000</td>
      <td>25000</td>
      <td>NaN</td>
      <td>42500</td>
    </tr>
    <tr>
      <th>placed</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>start_date</th>
      <td>2020-01-08 00:00:00</td>
      <td>2020-01-15 00:00:00</td>
      <td>2020-01-30 00:00:00</td>
      <td>NaT</td>
      <td>2020-01-16 00:00:00</td>
    </tr>
    <tr>
      <th>end_date</th>
      <td>2020-04-17 00:00:00</td>
      <td>2020-04-02 00:00:00</td>
      <td>2020-04-27 00:00:00</td>
      <td>NaT</td>
      <td>2020-04-28 00:00:00</td>
    </tr>
    <tr>
      <th>duration</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As we learned in the <a class="reference internal" href="01_Tabular_Models.html"><span class="doc">Tabular Models</span></a> guide, we can make the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model learn the data by calling its <code class="docutils literal notranslate"><span class="pre">fit</span></code> methods:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.tabular</span> <span class="kn">import</span> <span class="n">GaussianCopula</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>During these steps, the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> model has performed the following operations:</p>
<ol class="arabic simple">
<li><p>Learn the format and data types of the passed data</p></li>
<li><p>Transform the non-numerical and null data using <a class="reference external" href="https://github.com/sdv-dev/RDT">Reversible Data Transforms</a> to obtain a fully numerical representation of the data from which we can learn the probability distributions.</p></li>
<li><p>Learn the probability distribution of each column from the table</p></li>
<li><p>Learn the correlation between the marginal probabilities using a Gaussian Copula.</p></li>
</ol>
<p>After this, we are ready to sample new data for our table using the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method, which will:</p>
<ol class="arabic simple" start="5">
<li><p>Sample from a Multivariate Standard Normal distribution with the learned correlations.</p></li>
<li><p>Reverse the sampled probabilities using the marginal distributions.</p></li>
<li><p>Reverse the RDT transformations to go back to the original data format.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>student_id</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>F</td>
      <td>M</td>
      <td>F</td>
      <td>M</td>
      <td>F</td>
    </tr>
    <tr>
      <th>second_perc</th>
      <td>72.518</td>
      <td>65.0203</td>
      <td>54.616</td>
      <td>84.3534</td>
      <td>51.2264</td>
    </tr>
    <tr>
      <th>high_perc</th>
      <td>76.7083</td>
      <td>65.7491</td>
      <td>79.8384</td>
      <td>96.3179</td>
      <td>60.0453</td>
    </tr>
    <tr>
      <th>high_spec</th>
      <td>Commerce</td>
      <td>Commerce</td>
      <td>Science</td>
      <td>Commerce</td>
      <td>Science</td>
    </tr>
    <tr>
      <th>degree_perc</th>
      <td>75.0649</td>
      <td>65.7111</td>
      <td>74.5394</td>
      <td>63.8325</td>
      <td>63.6829</td>
    </tr>
    <tr>
      <th>degree_type</th>
      <td>Sci&amp;Tech</td>
      <td>Comm&amp;Mgmt</td>
      <td>Comm&amp;Mgmt</td>
      <td>Sci&amp;Tech</td>
      <td>Sci&amp;Tech</td>
    </tr>
    <tr>
      <th>work_experience</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>experience_years</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>employability_perc</th>
      <td>88.9081</td>
      <td>50.1851</td>
      <td>93.8224</td>
      <td>89.7458</td>
      <td>89.8229</td>
    </tr>
    <tr>
      <th>mba_spec</th>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;Fin</td>
      <td>Mkt&amp;HR</td>
      <td>Mkt&amp;HR</td>
    </tr>
    <tr>
      <th>mba_perc</th>
      <td>69.6575</td>
      <td>62.1093</td>
      <td>72.0788</td>
      <td>67.2512</td>
      <td>58.8071</td>
    </tr>
    <tr>
      <th>salary</th>
      <td>NaN</td>
      <td>37779.8</td>
      <td>NaN</td>
      <td>36643.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>placed</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>start_date</th>
      <td>NaT</td>
      <td>2020-01-31 17:05:38.304327168</td>
      <td>NaT</td>
      <td>2020-07-29 23:17:05.962566400</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>end_date</th>
      <td>NaT</td>
      <td>2020-09-04 21:32:44.011475968</td>
      <td>NaT</td>
      <td>2021-01-26 23:39:37.997646336</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>duration</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Exploring-the-Probability-Distributions">
<h2>Exploring the Probability Distributions<a class="headerlink" href="#Exploring-the-Probability-Distributions" title="Permalink to this headline">¶</a></h2>
<p>During the pervious steps we learned that the Marginal Probability Distributions have a very important role during the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> modeling and sampling processes, in which the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> had to learn the individual distributions of each column in our table.</p>
<p>We can explore the distributions which the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> used to model each column using its <code class="docutils literal notranslate"><span class="pre">get_distributions</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distributions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_distributions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>This will return us a <code class="docutils literal notranslate"><span class="pre">dict</span></code> which contains the name of the distribution class used for each column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distributions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;gender#0&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;gender#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;second_perc&#39;: &#39;copulas.univariate.truncated_gaussian.TruncatedGaussian&#39;,
 &#39;high_perc&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;high_spec#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;high_spec#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;high_spec#2&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;degree_perc&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,
 &#39;degree_type#0&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,
 &#39;degree_type#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;degree_type#2&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;work_experience&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;,
 &#39;experience_years&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;employability_perc&#39;: &#39;copulas.univariate.truncated_gaussian.TruncatedGaussian&#39;,
 &#39;mba_spec#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;mba_spec#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;mba_perc&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;salary#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;salary#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;placed&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;start_date#0&#39;: &#39;copulas.univariate.gamma.GammaUnivariate&#39;,
 &#39;start_date#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;end_date#0&#39;: &#39;copulas.univariate.beta.BetaUnivariate&#39;,
 &#39;end_date#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;duration#0&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;duration#1&#39;: &#39;copulas.univariate.gaussian.GaussianUnivariate&#39;,
 &#39;duration#2&#39;: &#39;copulas.univariate.student_t.StudentTUnivariate&#39;}
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTE</strong></p>
<p>In this list we will see multiple distributions for each one of the columns that we have in our data. This is because the RDT transformations used to encode the data numerically often use more than one column to represent each one of the input variables.</p>
</div>
<p>Let’s explore the individual distribution of one of the columns in our data to better understand how the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> processed them and see if we can improve the results by manually specifying a different distribution.</p>
<p>For example, let’s explore the <code class="docutils literal notranslate"><span class="pre">experience_years</span></code> column by looking at the frequency of its values within the original data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    141
1     62
2      9
3      2
4      1
Name: experience_years, dtype: int64
</pre></div></div>
</div>
<p>And plotting it using the <code class="docutils literal notranslate"><span class="pre">copulas.visualization</span></code> functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">copulas.visualization</span> <span class="kn">import</span> <span class="n">hist_1d</span>

<span class="n">hist_1d</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">experience_years</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f884bbdda20&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_20_1.png" src="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_20_1.png" />
</div>
</div>
<p>By observing the data we can see that the behavior of the values in this column is very similar to a Gamma or even some types of Beta distribution, where the majority of the values are 0 and the frequency decreases as the values increase.</p>
<p>Was the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> able to capture this distribution on its own?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distributions</span><span class="p">[</span><span class="s1">&#39;experience_years&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;copulas.univariate.gaussian.GaussianUnivariate&#39;
</pre></div></div>
</div>
<p>It seems that the it was not, as it rather thought that the behavior was closer to a Gaussian distribution.</p>
<p>And, as a result, we can see how the generated values now contain negative values which are invalid for this column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 0    109
 1     77
-1     18
 2     10
-2      1
Name: experience_years, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hist_1d</span><span class="p">(</span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f884bb6beb8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_25_1.png" src="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_25_1.png" />
</div>
</div>
<p>Let’s see how we can improve this situation by passing the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> the exact distribution that we want it to use for this column.</p>
</div>
<div class="section" id="Customizing-the-Probability-Distributions">
<h2>Customizing the Probability Distributions<a class="headerlink" href="#Customizing-the-Probability-Distributions" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> class offers the possibility to indicate which distribution to use for each one of the columns in the table, in order to solve situations like the one that we just described.</p>
<p>In order to do this, we need to pass a <code class="docutils literal notranslate"><span class="pre">distributions</span></code> argument with <code class="docutils literal notranslate"><span class="pre">dict</span></code> that indicates, the distribution that we want to use for each column.</p>
<p>Possible values for the distribution argument are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">univariate</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution. This may result in non-parametric models being used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution, but restrict the selection to parametric distributions only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution, but restrict the selection to bounded distributions only. This may result in non-parametric models being used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">semi_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution, but restrict the selection to semi-bounded distributions only. This may result in non-parametric models being used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution, but restrict the selection to parametric and bounded distributions only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric_semi_bounded</span></code>: Let <code class="docutils literal notranslate"><span class="pre">copulas</span></code> select the optimal univariate distribution, but restrict the selection to parametric and semi-bounded distributions only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian</span></code>: Use a Gaussian distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code>: Use a Gamma distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta</span></code>: Use a Beta distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">student_t</span></code>: Use a Student T distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gussian_kde</span></code>: Use a GaussianKDE distribution. This model is non-parametric, so using this will make <code class="docutils literal notranslate"><span class="pre">get_parameters</span></code> unusable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truncated_gaussian</span></code>: Use a Truncated Gaussian distribution.</p></li>
</ul>
<p>Let’s see what happens if we make the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> use the <code class="docutils literal notranslate"><span class="pre">beta</span></code> distribution for our column.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sdv.tabular</span> <span class="kn">import</span> <span class="n">GaussianCopula</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianCopula</span><span class="p">(</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">,</span>
    <span class="n">distribution</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;experience_years&#39;</span><span class="p">:</span> <span class="s1">&#39;beta&#39;</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After this, we can see how the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> used the indicated distribution for the <code class="docutils literal notranslate"><span class="pre">experience_years</span></code> column</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">get_distributions</span><span class="p">()[</span><span class="s1">&#39;experience_years&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;copulas.univariate.beta.BetaUnivariate&#39;
</pre></div></div>
</div>
<p>And, as a result, now we can see how the generated data now have a behavior which is closer to the original data and always stays within the valid values range.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    144
1     27
3     16
2     16
4     12
Name: experience_years, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_data</span><span class="o">.</span><span class="n">experience_years</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f884b9e8a58&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_34_1.png" src="../../_images/tutorials_single_table_data_02_GaussianCopula_Model_34_1.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title"><strong>NOTE</strong></p>
<p>Even though there are situations like the one show above where manually choosing a distribution seems to give better results, in most cases the <code class="docutils literal notranslate"><span class="pre">GaussianCopula</span></code> will be able to find the optimal distribution on its own, making this manual search of the marginal distributions necessary on very little occasions.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="01_Tabular_Models.html" title="previous page">Tabular Models</a>
    <a class='right-next' id="next-link" href="03_CTGAN_Model.html" title="next page">CTGAN Model</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.30270b6e4c972e43c488.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>